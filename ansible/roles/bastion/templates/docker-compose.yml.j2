services:
  nginx:
    image: docker.io/library/nginx:1.27-alpine
    container_name: rp-nginx
    restart: unless-stopped
    ports: [ "80:80", "443:443" ]
    volumes:
      - /etc/nginx/nginx.conf:/etc/nginx/nginx.conf:ro
      - /etc/nginx/conf.d:/etc/nginx/conf.d:ro
      - /etc/nginx/snippets:/etc/nginx/snippets:ro
      - /etc/nginx/tls:/etc/nginx/tls:ro
      - {{ ssl_dir }}:{{ ssl_dir }}:ro
    healthcheck:
      test: ["CMD","nginx","-t"]
      interval: 30s
      timeout: 5s
      retries: 3